{% extends 'base.html' %}

{% block title %}PWOA — Daily Plan{% endblock %}

{% block content %}
<div>
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-2xl font-semibold">Daily Plan</h2>
    <a href="/ui/tasks" class="text-indigo-600 hover:underline">Tasks</a>
  </div>

  <div id="plan-area">
    <p class="text-gray-500">Generating plan...</p>
  </div>

</div>
{% endblock %}

{% block scripts %}
<script>
async function loadPlan(){
  const res = await fetch('/api/schedule/today');
  const area = document.getElementById('plan-area');
  if(!res.ok){ area.innerHTML = '<div class="text-yellow-600">Could not generate plan</div>'; return; }
  const data = await res.json();
  let html = '';
  html += '<h5 class="text-lg font-medium">Today</h5>';
  if(data.today && data.today.length){
    html += '<ul class="space-y-2 mb-4">';
    data.today.forEach(t=>{
      html += `<li class="p-2 border rounded"><strong>${t.description}</strong> — ${t.estimated_time_minutes} min</li>`;
    });
    html += '</ul>';
  } else html += '<p class="text-gray-500">No tasks scheduled for today.</p>';

  html += '<h5 class="text-lg font-medium">Tomorrow</h5>';
  if(data.tomorrow && data.tomorrow.length){
    html += '<ul class="space-y-2 mb-4">';
    data.tomorrow.forEach(t=>{ html += `<li class="p-2 border rounded">${t.description}</li>`; });
    html += '</ul>';
  }

  html += '<h5 class="text-lg font-medium">This Week</h5>';
  if(data.this_week && data.this_week.length){
    html += '<ul class="space-y-2 mb-4">';
    data.this_week.forEach(t=>{ html += `<li class="p-2 border rounded">${t.description}</li>`; });
    html += '</ul>';
  }

  area.innerHTML = html;
}
loadPlan();
</script>
{% endblock %}
